(this["webpackJsonpvizzion-client"]=this["webpackJsonpvizzion-client"]||[]).push([[0],{68:function(e,t,n){e.exports=n(81)},73:function(e,t,n){},74:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},75:function(e,t,n){},81:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(11),i=n.n(r),c=(n(73),n(10)),l=(n(74),n(75),n(55)),s=n(131),u=n(137),m=n(117),d=n(118),g=n(133),p=n(120),h=n(121),f=n(122),E=n(116),b=n(27),v=n.n(b),x=n(132),O=function(e){var t=Object(a.useState)(!1),n=Object(c.a)(t,2),r=n[0],i=n[1],l=Object(a.useRef)(null),s=function(e){l.current&&!l.current.contains(e.target)&&i(!1)};return Object(a.useEffect)((function(){return document.addEventListener("click",s,!0),function(){document.removeEventListener("click",s,!0)}})),o.a.createElement("div",{ref:l,className:"nav-item"},o.a.createElement("span",{className:"nav-label",onClick:function(e){console.log(e),i(!r)}},"SELECT REGION"),r&&e.children)};function w(e){var t=Object(a.useState)("main"),n=Object(c.a)(t,2),r=n[0],i=n[1],l=Object(a.useState)(void 0),s=Object(c.a)(l,2),u=s[0],m=s[1],d=Object(a.useState)(void 0),g=Object(c.a)(d,2),p=g[0],h=g[1],f=Object(a.useState)(null),E=Object(c.a)(f,2),b=E[0],O=E[1],w=Object(a.useState)("normal"),y=Object(c.a)(w,2),j=y[0],S=y[1],N=Object(a.useState)(""),k=Object(c.a)(N,2),C=k[0],L=k[1],R=Object(a.useState)(""),T=Object(c.a)(R,2),A=T[0],D=T[1],M=function(e){var t=e.offsetHeight;O(t)},z=function(t){console.log("REGIONS"),e.handleRegionSelect(t)};function I(e){return o.a.createElement("div",{className:"menu-item ".concat(e.sticky&&"menu-fixed"),onClick:function(){e.goToMenu?function(e){console.log("click ",e),"main"===r?S("normal"):"states"===r&&"main"===e.goToMenu?S("reverse"):"states"===r&&"regions"===e.goToMenu?S("normal"):S("reverse"),e.stateList&&m(e.stateList),e.regionList&&h(e.regionList),e.countryLabel&&L(e.countryLabel),e.stateLabel&&D(e.stateLabel),i(e.goToMenu)}(e):e.regionData&&z(e.regionData)}},e.children)}return o.a.createElement("div",{className:"dropdown",style:{height:b}},o.a.createElement(x.a,{in:"main"===r,unmountOnExit:!0,timeout:500,classNames:"menu-primary",onEnter:M},o.a.createElement("div",{className:"menu"},e.regions?e.regions.countries.map((function(e,t){return o.a.createElement(I,{goToMenu:"states",countryLabel:e.name,stateList:e.states},e.name)})):o.a.createElement(I,null,"LOADING REGIONS..."))),o.a.createElement(x.a,{in:"states"===r,unmountOnExit:!0,timeout:500,classNames:{enter:"normal"===j?"menu-secondary-enter":"menu-primary-enter",enterActive:"normal"===j?"menu-secondary-enter-active":"menu-primary-enter-active",exit:"normal"===j?"menu-primary-exit":"menu-secondary-exit",exitActive:"normal"===j?"menu-primary-exit-active":"menu-secondary-exit-active"},onEnter:M},o.a.createElement("div",{className:"menu"},u?o.a.createElement(o.a.Fragment,null,o.a.createElement(I,{sticky:!0,goToMenu:"main"},o.a.createElement(v.a,null),C),u.map((function(e){return o.a.createElement(I,{goToMenu:"regions",stateLabel:e.name,regionList:e.regions},e.name)}))):o.a.createElement(o.a.Fragment,null,o.a.createElement(I,{goToMenu:"main"},o.a.createElement(v.a,null),C),o.a.createElement(I,{goToMenu:"regions"},"Loading States")))),o.a.createElement(x.a,{in:"regions"===r,unmountOnExit:!0,timeout:500,classNames:"menu-tertiary",onEnter:M},o.a.createElement("div",{className:"menu"},p?o.a.createElement(o.a.Fragment,null,o.a.createElement(I,{sticky:!0,goToMenu:"states"},o.a.createElement(v.a,null),A),p.map((function(e){return o.a.createElement(I,{regionData:e},e.name)}))):o.a.createElement(o.a.Fragment,null,o.a.createElement(I,{sticky:!0,goToMenu:"states"},o.a.createElement(v.a,null),A),o.a.createElement(I,null,"Loading Regions")))))}var y=function(e){return o.a.createElement(O,null,o.a.createElement(w,{handleRegionSelect:function(t){e.handleRegionSelect(t)},regions:e.regions}))},j=Object(E.a)((function(e){return{root:{display:"flex",fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif'},drawer:{width:240,flexShrink:0,display:"flex",flexDirection:"column",position:"relative"},drawerPaper:{width:240},drawerTitle:{fontSize:"24px",fontWeight:"bold",padding:"10px",fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif'},drawerBody:{padding:"0px 10px"},buttonGroup:{padding:"20px 0px",display:"flex",alignContent:"space-between","& button":{flexGrow:1}},drawerToggle:{display:"flex",alignItems:"center",position:"absolute",right:0,top:5,radius:"5px",backgroundColor:"white",zIndex:10,boxShadow:"0px 2px 1px -1px rgba(0,0,0,0.2)"},content:{flexGrow:1,position:"relative",transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginRight:-240},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginRight:0},tooltip:{display:"flex",flexDirection:"column",width:"300px","& img":{height:"auto",maxWidth:"300px"}}}})),S=function(e){var t=j();return o.a.createElement(s.a,{className:t.drawer,variant:"persistent",anchor:"right",open:e.open,classes:{paper:t.drawerPaper}},o.a.createElement("div",{className:t.drawerTitle},"Toolbar"),o.a.createElement("div",{className:t.drawerBody},o.a.createElement(u.a,{margin:"normal"},o.a.createElement(m.a,null,"Change Search Area"),o.a.createElement(d.a,{label:"Toggle Area Edit",control:o.a.createElement(g.a,{checked:e.editSwitch,onChange:e.handleSwitch,name:"checkedA",inputProps:{"aria-label":"secondary checkbox"}})}),o.a.createElement(p.a,null,"Select two points to create new search rectangle"),o.a.createElement(h.a,{className:t.buttonGroup,row:!0},o.a.createElement(f.a,{onClick:e.handleUpdate,variant:"contained",color:"primary"},"Update"),o.a.createElement(f.a,{onClick:e.handleClear,variant:"contained"},"Clear")),o.a.createElement(h.a,null,o.a.createElement(f.a,{variant:"contained",color:"secondary",onClick:e.downloadContent},"Export")),o.a.createElement(h.a,{style:{paddingTop:20}},o.a.createElement(y,{handleRegionSelect:e.handleRegionSelect,regions:e.regionData})))))},N=n(136),k=n(134),C=n(123),L=n(124),R=n(135),T=n(125),A=n(3),D=n(12),M=n.n(D),z=n(119),I=n(49),G=n.n(I),F=Object(E.a)((function(e){return{root:{display:"flex",height:"100%"},drawer:{width:240,flexShrink:0,display:"flex",flexDirection:"column",position:"relative"},drawerPaper:{width:240},drawerTitle:{fontSize:"24px",fontWeight:"bold",padding:"10px"},drawerBody:{padding:"0px 10px"},buttonGroup:{padding:"20px 0px",display:"flex",alignContent:"space-between","& button":{flexGrow:1}},drawerToggle:{display:"flex",alignItems:"center",position:"absolute",right:0,top:5,radius:"5px",backgroundColor:"white",zIndex:10,boxShadow:"0px 2px 1px -1px rgba(0,0,0,0.2)"},content:{flexGrow:1,position:"relative",transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginRight:-240},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginRight:0},tooltip:{display:"flex",flexDirection:"column",width:"300px","& img":{height:"auto",maxWidth:"300px"}}}})),U=M.a.icon({iconUrl:"camera.png",iconAnchor:[16,16],popupAnchor:[-3,-16]}),B=M.a.icon({iconUrl:"hotspot_camera.png",iconAnchor:[16,16],popupAnchor:[-3,-16]}),W=(M.a.circle({color:"red",fillColor:"red",opacity:.75,radius:5e3}),function(e){var t=Object(a.useState)({lat:43.6475,long:-79.3811,zoom:13}),n=Object(c.a)(t,2),r=n[0],i=n[1],s=Object(a.useState)([]),u=Object(c.a)(s,2),m=u[0],d=u[1],g=Object(a.useState)(!0),p=Object(c.a)(g,2),h=p[0],E=p[1],b=Object(a.useState)(!1),x=Object(c.a)(b,2),O=x[0],w=x[1],y=Object(a.useState)(!1),j=Object(c.a)(y,2),D=j[0],M=j[1],I=Object(a.useState)(!1),W=Object(c.a)(I,2),P=(W[0],W[1],Object(a.useState)(!1)),H=Object(c.a)(P,2),J=(H[0],H[1],F()),$=function(){w(!O)},_=function(){2===m.length&&(e.handleNewRectangle(m),d([]))};var q=function(){console.log("load"),document.getElementById("imageDiv").style.display="inherit"};return o.a.createElement("div",{className:J.root},e.loading&&o.a.createElement("div",{className:"spinnerDiv"},o.a.createElement("div",{className:"spinnerText"},"Loading Cameras"),o.a.createElement("div",{className:"spinner"},o.a.createElement("div",{className:"double-bounce1"}),o.a.createElement("div",{className:"double-bounce2"}))),e.error&&o.a.createElement("div",{className:"spinnerDiv"},o.a.createElement("div",{className:"spinnerText"},e.errorMessage)),o.a.createElement("div",{className:Object(A.a)(J.content,Object(l.a)({},J.contentShift,O))},o.a.createElement("div",{onClick:$,className:J.drawerToggle},o.a.createElement(z.a,{onClick:$},O?o.a.createElement(G.a,null):o.a.createElement(v.a,null))),o.a.createElement(N.a,{style:{cursor:h&&"pointer"},onClick:function(e){if(console.log(e),h){var t=[e.latlng.lat.toFixed(3),e.latlng.lng.toFixed(3)];if(console.log(t),0===m.length)d([t]);else if(1===m.length){var n=m[0];console.log(n,t),d([n,t])}else 2!==m.length||D?D&&M(!1):d([t])}},center:[r.lat,r.long],zoom:r.zoom},o.a.createElement(k.a,{style:{cursor:h&&"pointer !important"},attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),2===e.searchArea.length&&o.a.createElement(C.a,{color:"purple",bounds:e.searchArea}),1===m.length&&o.a.createElement(L.a,{color:"red",opacity:1,radius:2,center:m[0]}),2===m.length&&o.a.createElement(C.a,{onClick:function(e){M(!0),console.log("click rectangle",e)},color:"red",bounds:m},o.a.createElement(R.a,null,o.a.createElement(f.a,{onClick:_},"Update Search"))),e.cameras&&e.cameras.map((function(e){return o.a.createElement(T.a,{key:e.id,position:[e.lat,e.long],icon:e.hotspot?B:U},o.a.createElement(R.a,null,o.a.createElement("div",{className:J.tooltip},o.a.createElement("div",{id:"imageDiv",style:{display:"none"}},o.a.createElement("img",{onError:function(e){e.target.onError=null,e.target.src="/NoImage"},onLoad:q,src:"/image/".concat(e.id)})),o.a.createElement("div",null,o.a.createElement("strong",null,"ID: "),e.id),o.a.createElement("div",null,o.a.createElement("strong",null,"Name: "),e.name))))})))),o.a.createElement(S,{open:O,editSwitch:h,handleSwitch:function(e){E(!h)},handleUpdate:_,handleClear:function(){d([]),e.handleReset()},downloadContent:function(){try{var t=document.createElement("a"),n="";e.cameras.map((function(e){return n+=e.id+"\n"}));var a=new Blob([n],{type:"text/plain"});t.href=URL.createObjectURL(a),t.download="cameraList",t.click()}catch(o){console.log("Error Exporting Data")}},regionData:e.regionData,handleRegionSelect:function(t){console.log("region selected in MAp!",t),i({lat:t.center[0],long:t.center[1],zoom:10}),d([t.pt1,t.pt2]),e.handleNewRectangle([t.pt1,t.pt2])}}))});n(127),n(126),n(128),n(129),n(130),n(60),n(61),Object(E.a)((function(e){return{root:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper},nested:{paddingLeft:e.spacing(4)}}}));var P=function(){var e=Object(a.useState)(null),t=Object(c.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)(!0),l=Object(c.a)(i,2),s=l[0],u=l[1],m=Object(a.useState)([]),d=Object(c.a)(m,2),g=d[0],p=d[1],h=Object(a.useState)(!1),f=Object(c.a)(h,2),E=f[0],b=f[1],v=Object(a.useState)(null),x=Object(c.a)(v,2),O=x[0],w=x[1],y=Object(a.useState)(null),j=Object(c.a)(y,2),S=j[0],N=j[1];Object(a.useEffect)((function(){console.log("useEffect"),C(),k()}),[]);var k=function(){console.log("get regions"),fetch("/regions").then((function(e){if(e.ok)return e.json()})).then((function(e){N(e)}))},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log("get Data",e),r(null),w(null);var n="/api";""!=e&&(n="/api/".concat(e,",").concat(t)),console.log("/api/".concat(e,",").concat(t)),fetch(n).then((function(e){if(console.log(e),e.ok)return e.json();throw Error("".concat(e.statusText))})).then((function(e){console.log(e),r(e.cameraData),p(e.searchArea),u(!1)})).catch((function(e){console.log(e.message),b(!0),u(!1),"Not Found"===e.message?(console.log("this error"),w("No Cameras Available")):w("Error fetching data")}))};return o.a.createElement("div",{className:"App"},o.a.createElement(W,{handleReset:function(){b(null)},handleNewRectangle:function(e){console.log("App",e),u(!0),b(null),p(e),r(null),C(e[0],e[1])},cameras:n,searchArea:g,loading:s,error:E,errorMessage:O,regionData:S}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(P,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[68,1,2]]]);
//# sourceMappingURL=main.0d889880.chunk.js.map